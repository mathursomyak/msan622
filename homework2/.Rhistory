data(movies)
movies1 <- subset(movies,budget>0) #filter out movies with a negative budget
movies1 <- subset(movies1,(mpaa)!='') #filter out movies without an mpaa rating
genre <- rep(NA, nrow(movies1))
count <- rowSums(movies1[, 18:24])
genre[which(count > 1)] = "Mixed"
genre[which(count < 1)] = "None"
genre[which(count == 1 & movies1$Action == 1)] = "Action"
genre[which(count == 1 & movies1$Animation == 1)] = "Animation"
genre[which(count == 1 & movies1$Comedy == 1)] = "Comedy"
genre[which(count == 1 & movies1$Drama == 1)] = "Drama"
genre[which(count == 1 & movies1$Documentary == 1)] = "Documentary"
genre[which(count == 1 & movies1$Romance == 1)] = "Romance"
genre[which(count == 1 & movies1$Short == 1)] = "Short"
movies1$genre <- genre
movies1$mpaa <- factor(movies1$mpaa, levels = c("NC-17","R","PG-13","PG"))
return(movies1)
}
movies1 <- getDataShapedUp()
ggplot(data=movies1, aes(x=budget,
y=rating,
color=as.factor(mpaa)
)) +
geom_point(alpha = 0.5) +
#ggtitle("title")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank()
legend.position = "bottom")+
labs(color = "MPAA Rating")+
scale_color_brewer(palette = "Dark2")
movies1 <- getDataShapedUp()
ggplot(data=movies1, aes(x=budget,
y=rating,
color=as.factor(mpaa)
)) +
geom_point(alpha = 0.5) +
#ggtitle("title")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank()
legend.position = "bottom")
ggplot(data=movies1, aes(x=budget,
y=rating,
color=as.factor(mpaa)
)) +
geom_point(alpha = 0.5) +
#ggtitle("title")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank(),
legend.position = "bottom")+
labs(color = "MPAA Rating")+
scale_color_brewer(palette = "Dark2")
ggplot(data=movies1, aes(x=budget,
y=rating,
color=as.factor(mpaa)
)) +
geom_point(alpha = 0.5, size = 8) +
#ggtitle("title")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank(),
legend.position = "bottom")+
labs(color = "MPAA Rating")+
scale_color_brewer(palette = "Dark2")
runApp()
runApp()
runApp()
runApp()
runApp()
runApp()
library(shiny)
library(ggplot2)
runApp()
runApp()
View(movies1)
runApp()
runApp()
movies1 <- getDataShapedUp()
ggplot(data=movies1, aes(x=budget,
y=rating,
color=as.factor(mpaa)
)) +
geom_point(data = subset(movies1, mpaa=="R"),alpha = 0.5, size = 8) +
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank(),
legend.position = "bottom")+
labs(color = "MPAA Rating")+
scale_color_brewer(palette = "Dark2")
ggplot(data=movies1, aes(x=budget,
y=rating,
color=as.factor(mpaa)
)) +
geom_point(data = subset(movies1, mpaa=="R"),alpha = 0.5, size = 8) +
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 3),
panel.background = element_blank(),
legend.position = "bottom")+
labs(color = "MPAA Rating")+
scale_color_brewer(palette = "Dark2")
ggplot(data=movies1, aes(x=budget,
y=rating,
color=as.factor(mpaa)
)) +
geom_point(data = subset(movies1, mpaa=="R"),alpha = 0.5, size = 3) +
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank(),
legend.position = "bottom")+
labs(color = "MPAA Rating")+
scale_color_brewer(palette = "Dark2")
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, mpaa=="R"),alpha = 0.5, size = 3,color=as.factor(mpaa)) +
geom_point(data = subset(movies1, mpaa!="R"),alpha = 0.5, size = 3,color="grey")
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank(),
legend.position = "bottom")+
labs(color = "MPAA Rating")+
scale_color_brewer(palette = "Dark2")
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, mpaa=="R"),alpha = 0.5, size = 3,color=as.factor(mpaa)) +
geom_point(data = subset(movies1, mpaa!="R"),alpha = 0.5, size = 3,color="grey")
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank(),
legend.position = "bottom")+
#labs(color = "MPAA Rating")+
scale_color_brewer(palette = "Dark2")
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, mpaa=="R"),alpha = 0.5, size = 3,color=as.factor(mpaa)) +
geom_point(data = subset(movies1, mpaa!="R"),alpha = 0.5, size = 3,color="grey")
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank(),
legend.position = "bottom")
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, mpaa=="R"),alpha = 0.5, size = 3,color=as.factor(mpaa)) +
geom_point(data = subset(movies1, mpaa!="R"),alpha = 0.5, size = 3,color="grey")
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() )#,
#legend.position = "bottom")
#labs(color = "MPAA Rating")+
#scale_color_brewer(palette = "Dark2")
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, mpaa=="R"),alpha = 0.5, size = 3,color=as.factor(mpaa)) +
geom_point(data = subset(movies1, mpaa!="R"),alpha = 0.5, size = 3,color="grey")
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() )
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, mpaa=="R"),alpha = 0.5, size = 3,color=as.factor(mpaa)) +
geom_point(data = subset(movies1, mpaa!="R"),alpha = 0.5, size = 3,color="grey")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() )#,
View(movies1)
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, movies1$mpaa=="R"),alpha = 0.5, size = 3,color=as.factor(mpaa)) +
geom_point(data = subset(movies1, movies1$mpaa!="R"),alpha = 0.5, size = 3,color="grey")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() )#,
movies1 <- getDataShapedUp()
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, movies1$mpaa=="R"),alpha = 0.5, size = 3,color=as.factor(mpaa)) +
geom_point(data = subset(movies1, movies1$mpaa!="R"),alpha = 0.5, size = 3,color="grey")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() )#,
is.factor(movies1$mpaa)
movies1$mpaa
movies1$mpaa!="R"
subset(movies1, movies1$mpaa!="R")
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, movies1$mpaa=="R"),alpha = 0.5, size = 3,color= "green") +
geom_point(data = subset(movies1, movies1$mpaa!="R"),alpha = 0.5, size = 3,color="grey")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() )#,
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, movies1$mpaa=="R"),alpha = 0.5, size = 3,color="Dark2") +
geom_point(data = subset(movies1, movies1$mpaa!="R"),alpha = 0.5, size = 3,color="grey")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() )#,
ggplot(data=movies1, aes(x=budget,
y=rating
)) +
geom_point(data = subset(movies1, movies1$mpaa=="R"),alpha = 0.5, size = 3,color="Dark2[1]") +
geom_point(data = subset(movies1, movies1$mpaa!="R"),alpha = 0.5, size = 3,color="grey")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() )#,
brewer_pal(type = "qual", palette = "Set1")(3)
library(scales)
brewer_pal(type = "qual", palette = "Set1")(3)
pal <- brewer_pal(type = "qual", paletter = Set1)(4)
pal <- brewer_pal(type = "qual", palette = Set1)(4)
pal <- brewer_pal(type = "qual", palette = "Set1")(4)
ggplot(data=movies1, aes(x=budget, y=rating, color=as.factor(mpaa))) +
geom_point(alpha = 0.5, size = 3,) +
geom_point(data = subset(movies1, movies1$mpaa!="R"),alpha = 0.5, size = 3,color="grey")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() )#,
legend.position = "bottom")
labs(color = "MPAA Rating")+
scale_color_brewer(palette = pal)
ggplot(data=movies1, aes(x=budget, y=rating, color=as.factor(mpaa))) +
geom_point(alpha = 0.5, size = 3,) +
geom_point(data = subset(movies1, movies1$mpaa!="R"),alpha = 0.5, size = 3,color="grey")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() ,
legend.position = "bottom") +
labs(color = "MPAA Rating") +
scale_color_brewer(palette = pal)
?brewer_pal
show_col(brewer_pal("qual")(4))
pal
ggplot(data=movies1, aes(x=budget, y=rating, color=as.factor(mpaa))) +
geom_point(alpha = 0.5, size = 3,) +
geom_point(data = subset(movies1, movies1$mpaa!="R"),alpha = 0.5, size = 3,color="grey")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() ,
legend.position = "bottom") +
labs(color = "MPAA Rating") +
scale_fill_manual(values = pal)
ggplot(data=movies1, aes(x=budget, y=rating, color=as.factor(mpaa))) +
geom_point(alpha = 0.5, size = 3,) +
#geom_point(data = subset(movies1, movies1$mpaa!="R"),alpha = 0.5, size = 3,color="grey")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 12),
panel.background = element_blank() ,
legend.position = "bottom") +
labs(color = "MPAA Rating") +
scale_fill_manual(values = pal)
levels(mpaa)
levels(movies1$mpaa)
mpaacolors <- levels(movies1$mpaa)
paldf <- cbind(pal,mpaacolors)
View(paldf)
highlight <- "R"
show_col(brewer_pal("pastel2"))
?brewer_pal
show_col(brewer_pal(pal = "pastel2"))
highlight <- "R"
highlight <- "R"
pal <- brewer_pal(type = "qual", palette = "Set1")(4)
mpaas <- levels(movies1$mpaa)
paldf <- cbind(pal,mpaas)
newColor <- pal
newColor[which(mpaas)!=highlight] = "#bdbdbd"
newColor[which(paldf$mpaas!=highlight)] = "#bdbdbd"
newColor[which(mpaas!=highlight)] = "#bdbdbd"
paldf$newColor <- newColor
View(paldf)
pal <- brewer_pal(type = "qual", palette = "Set1")(4)
mpaas <- levels(movies1$mpaa)
paldf <- cbind(pal,mpaas)
newColor <- pal
newColor[which(mpaas!=highlight)] = "#bdbdbd"
paldf$newColor <- c(newColor)
paldf <- c(paldf,newColor)
highlight <- "R"
pal <- brewer_pal(type = "qual", palette = "Set1")(4)
mpaas <- levels(movies1$mpaa)
paldf <- cbind(pal,mpaas)
newColor <- pal
newColor[which(mpaas!=highlight)] = "#bdbdbd"
paldf <- c(paldf,newColor)
View(paldf)
highlight <- "R"
pal <- brewer_pal(type = "qual", palette = "Set1")(4)
mpaas <- levels(movies1$mpaa)
paldf <- cbind(pal,mpaas)
View(paldf)
paldf$newColor <- pal
View(paldf)
highlight <- "R"
pal <- brewer_pal(type = "qual", palette = "Set1")(4)
mpaas <- levels(movies1$mpaa)
paldf <- cbind(pal,mpaas)
paldf$newColor <- paldf$pal
View(paldf)
paldf$newColor <- paldf$pal
newColor <- paldf$pal
newColor <- paldf[pal]
newColor
newColor <- paldf[,1]
newColor
newColor[which(mpaas!=highlight)] = "#bdbdbd"
newColor
runApp()
runApp()
runApp()
makePlot(mov,input$alpha,input$size, input$palette, input$mpaa)
getDataShapedUp <- function(){
movies1 <- subset(movies,budget>0) #filter out movies with a negative budget
movies1 <- subset(movies1,(mpaa)!='') #filter out movies without an mpaa rating
genre <- rep(NA, nrow(movies1))
count <- rowSums(movies1[, 18:24])
genre[which(count > 1)] = "Mixed"
genre[which(count < 1)] = "None"
genre[which(count == 1 & movies1$Action == 1)] = "Action"
genre[which(count == 1 & movies1$Animation == 1)] = "Animation"
genre[which(count == 1 & movies1$Comedy == 1)] = "Comedy"
genre[which(count == 1 & movies1$Drama == 1)] = "Drama"
genre[which(count == 1 & movies1$Documentary == 1)] = "Documentary"
genre[which(count == 1 & movies1$Romance == 1)] = "Romance"
genre[which(count == 1 & movies1$Short == 1)] = "Short"
movies1$genre <- genre
movies1$mpaa <- factor(movies1$mpaa, levels = c("NC-17","R","PG-13","PG"))
return(movies1)
}
movies1 <- getDataShapedUp
colors <- function(PALETTE, MPAA){
highlight <- MPAA
pal <- brewer_pal(type = "qual", palette = PALETTE)(4)
#if(MPAA==5){return (pal)}
#else{
mpaas <- levels(movies1$mpaa)
paldf <- cbind(pal,mpaas)
newColor <- paldf[,1]
newColor[which(mpaas!=highlight)] = "#bdbdbd"
return (newColor)
#}
}
makePlot <- function(DATASET, ALPHA, SIZE, PALETTE, MPAA){
mypalette <- colors(PALETTE,MPAA)
plot <- ggplot(data= DATASET, aes(x=budget,y=rating,color=as.factor(mpaa))) +
geom_point(alpha = ALPHA, size = SIZE) +
#ggtitle("title")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 18),
panel.background = element_blank(),
legend.position = "bottom")+
labs(color = "MPAA Rating")+
xlab("Budget")+
scale_fill_manual(values = mypalette)
return(plot)
}
makePlot(mov,input$alpha,input$size, input$palette, input$mpaa)
makePlot(movies1,.5,3, "Dark2", "R")
makePlot(movies1,.5,3, "Dark2", "R")
colors <- function(PALETTE, MPAA, DATASET){
highlight <- MPAA
pal <- brewer_pal(type = "qual", palette = PALETTE)(4)
mpaas <- levels(DATASET1$mpaa)
paldf <- cbind(pal,mpaas)
newColor <- paldf[,1]
newColor[which(mpaas!=highlight)] = "#bdbdbd"
return (newColor)
}
movies1 <- getDataShapedUp()
runApp()
runApp()
colors("dark2","R",movies1)
levels(movies1$mpaa)
c(levels(movies$mpaa))
mpaas <- c("NC-17","R","PG-13","PG")
pal <- brewer_pal(type = "qual", palette = PALETTE)(4)
pal <- brewer_pal(type = "qual", palette = "dark2")(4)
pal <- brewer_pal(type = "qual", palette = "Dark2")(4)
paldf <- cbind(pal,mpaas)
newColor <- paldf[,1]
newColor[which(mpaas!=highlight)] = "#bdbdbd"
newColor
pal
runApp()
makePlot(movies1,0.5,3,"Dark2","R")
runApp()
library(ggplot2)
data(movies)
library(shiny)
getDataShapedUp <- function(){
movies1 <- subset(movies,budget>0) #filter out movies with a negative budget
movies1 <- subset(movies1,(mpaa)!='') #filter out movies without an mpaa rating
genre <- rep(NA, nrow(movies1))
count <- rowSums(movies1[, 18:24])
genre[which(count > 1)] = "Mixed"
genre[which(count < 1)] = "None"
genre[which(count == 1 & movies1$Action == 1)] = "Action"
genre[which(count == 1 & movies1$Animation == 1)] = "Animation"
genre[which(count == 1 & movies1$Comedy == 1)] = "Comedy"
genre[which(count == 1 & movies1$Drama == 1)] = "Drama"
genre[which(count == 1 & movies1$Documentary == 1)] = "Documentary"
genre[which(count == 1 & movies1$Romance == 1)] = "Romance"
genre[which(count == 1 & movies1$Short == 1)] = "Short"
movies1$genre <- genre
movies1$mpaa <- factor(movies1$mpaa, levels = c("NC-17","R","PG-13","PG"))
return(movies1)
}
movies1 <- getDataShapedUp()
colors <- function(PALETTE, MPAA){
highlight <- MPAA
pal <- brewer_pal(type = "qual", palette = PALETTE)(4)
mpaas <- c("NC-17","R","PG-13","PG")
paldf <- cbind(pal,mpaas)
newColor <- paldf[,1]
newColor[which(mpaas!=highlight)] = "#bdbdbd"
return (newColor)
}
colors("Dark2","R")
library(scales)
colors("Dark2","R")
makePlot <- function(DATASET, ALPHA, SIZE, PALETTE, MPAA){
mypalette <- colors(PALETTE,MPAA)
plot <- ggplot(data= DATASET, aes(x=budget,y=rating,color=as.factor(mpaa))) +
geom_point(alpha = ALPHA, size = SIZE) +
#ggtitle("title")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 18),
panel.background = element_blank(),
legend.position = "bottom")+
labs(color = "MPAA Rating")+
xlab("Budget")+
scale_fill_manual(values = mypalette)
return(plot)
}
makePlot(movies1,0.5,4,"Dark2","R")
makePlot <- function(DATASET, ALPHA, SIZE, PALETTE, MPAA){
mypalette <- colors(PALETTE,MPAA)
mypalette
plot <- ggplot(data= DATASET, aes(x=budget,y=rating,color=as.factor(mpaa))) +
geom_point(alpha = ALPHA, size = SIZE) +
#ggtitle("title")+
theme(panel.grid.major.x = element_blank()) +
theme(panel.grid.minor.y = element_blank()) +
theme(axis.ticks.x = element_blank(),
axis.text.x = element_text(size = 18),
panel.background = element_blank(),
legend.position = "bottom")+
labs(color = "MPAA Rating")+
xlab("Budget")+
scale_fill_manual(values = mypalette)
return(plot)
}
makePlot(movies1,0.5,4,"Dark2","R")
